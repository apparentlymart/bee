{% extends "base.html" %}

{% block htmltitle %}{{ author.first_name }}{% endblock %}

{% block controls %}
    <a id="control-new-post" class="button button-green" href="#">New post</a>

    {{ block.super }}

    <script type="text/javascript">
        $('#control-new-post').click(function () {
            if ($('#entry-editor').size())
                return false;

            $.ajax({
                url: '{{ STATIC_URL }}editor.html',
                dataType: 'html',
                success: function(data, textStatus, xhr) {
                    var $editor = $(data);
                    var $firstEntry = $('#content .entry').first();
                    $firstEntry.size() ? $firstEntry.before($editor) : $('#content').append($(data));
                    $('#entry-editor .entry-header').focus();
                }
            });
            return false;
        });
    </script>
{% endblock %}

{% block content %}

    {% for post in posts %}
        <div class="entry" id="entry-{{ post.atom_id|slugify }}">
            <h2 class="entry-header"><a href="{{ post.permalink }}">{{ post.title }}</a></h2>

            {% if post.avatar %}
            <a class="entry-author" title="{{ post.author.username }}" href="{{ post.author.permalink }}"><img src="{{ post.avatar.image_url }}" width="{{ post.avatar.width }}" height="{{ post.avatar.height }}"></a>
            {% else %}
            <a class="entry-author" title="{{ post.author.username }}" href="{{ post.author.permalink }}"><img src="https://si3.twimg.com/profile_images/1094090023/headface_reasonably_small.jpg" width="100" height="100"></a>
            {% endif %}

            <div class="entry-content pkg">
                {{ post.html|safe }}
            </div>
            <div class="entry-footer">
                <span class="entry-timestamp">{{ post.created|date:"g:i" }} <small>{{ post.created|date:"A" }}</small></span>
                <a href="{{ post.permalink }}">Permalink</a>
            </div>
        </div>
    {% endfor %}

{% endblock %}
